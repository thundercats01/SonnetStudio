<!doctype html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
    <div th:insert="partials/head :: head"></div>
    <title>Create Post</title>
    <style>

    </style>
</head>
<div th:insert="partials/navbar :: nav-bar"></div>

<body>

<div>

    <div class="test">
        <img th:src="@{/capstone_IMGs/Bg.jpeg}" class="d-block w-100 bg-index3">
    </div>

    <div class="container">
        <div class="row">
            <div class="d-flex flex-column justify-content-center text-center">
                <div class="row pt-3">
                    <div class="col-4 col-fit">
                        <div class="d-flex">
                            <img th:src="${currentBadge}" alt="badge" class="badge-img-1 border border-dark">
                        </div>
                        <div class="row">
                            <div class="d-flex align-items-center username-fontsize" th:text="${username}">
                                username
                            </div>
                        </div>
                    </div>
                    <div class="col-8">
                        <div class="card blurry-bg1 d-flex" style="width: 60%; border-radius: 2rem;">
                            <div class="card-body">
                                <div class="card-title border-bottom row">
                                    <h5 class="col">Create Post</h5>
                                </div>
                                <div class="row">
                                    <div class="col">
                                        <form id="myForm" th:action="@{/create}" method="post">
                                                    <textarea id="textToCheck" name="verseText" rows="3"
                                                              style="min-height: 40vh"
                                                              class="form-control form-custom flex-grow-1"
                                                              placeholder="Post a new message" required=""></textarea>
                                            <div class="row pt-1">
                                                <input type="button" class="btn btn-dark border-primary my-3"
                                                       id="createSubmit" value="Submit" onclick="profanityFilter()">
                                            </div>
                                        </form>
                                        <button id=" checkSpelling" type="button"
                                                class="btn btn-dark border-primary my-3">Check Spelling
                                                </button>
                                            </div>
                                            <!--                                            <div id="spellingCheckResults" class="mt-3"></div>-->
                                            <!--                                            <div class="col-sm">-->
                                            <!--                                                <a id="toggleBtn"-->
                                            <!--                                                    class="btn btn-primary rounded btn-size waves-effect waves-light col align-self-end">-->
                                            <!--                                                    AI-->
                                            <!--                                                </a>-->
                                            <!--                                            </div>-->
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>

                    <div class="row pt-4">
                        <!--                    <div class="row">-->
                        <!--                        <div class="col d-flex justify-content-center">-->
                        <!--                            <div class="card blurry-bg1 d-flex" style="width: 60%; border-radius: 2rem;">-->
                        <!--                                <div class="card-body">-->
                        <!--                                    <div class="card-title border-bottom row">-->
                        <!--                                        <h5 class="col">Create Post</h5>-->
                        <!--                                    </div>-->
                        <!--                                    <div class="row">-->
                        <!--                                        <div class="col">-->
                        <!--                                            <form id="myForm" th:action="@{/create}" method="post">-->
                        <!--                                                    <textarea id="textToCheck" name="verseText" rows="3"-->
                        <!--                                                              style="min-height: 40vh"-->
                        <!--                                                              class="form-control form-custom flex-grow-1"-->
                        <!--                                                              placeholder="Post a new message" required=""></textarea>-->
                        <!--                                                <div class="row pt-1">-->
                        <!--                                                    <input type="submit" class="btn btn-dark border-primary my-3">-->
                        <!--                                                </div>-->
                        <!--                                            </form>-->
                        <!--                                            <button id="checkSpelling" type="button"-->
                        <!--                                                    class="btn btn-dark border-primary my-3">Check Spelling-->
                        <!--                                            </button>-->
                        <!--                                        </div>-->
                        <!--                                        &lt;!&ndash;                                            <div id="spellingCheckResults" class="mt-3"></div>&ndash;&gt;-->
                        <!--                                        &lt;!&ndash;                                            <div class="col-sm">&ndash;&gt;-->
                        <!--                                        &lt;!&ndash;                                                <a id="toggleBtn"&ndash;&gt;-->
                        <!--                                        &lt;!&ndash;                                                    class="btn btn-primary rounded btn-size waves-effect waves-light col align-self-end">&ndash;&gt;-->
                        <!--                                        &lt;!&ndash;                                                    AI&ndash;&gt;-->
                        <!--                                        &lt;!&ndash;                                                </a>&ndash;&gt;-->
                        <!--                                        &lt;!&ndash;                                            </div>&ndash;&gt;-->
                        <!--                                    </div>-->
                        <!--                                </div>-->
                        <!--                            </div>-->
                        <!--                        </div>-->
                        <!--                    </div>-->
                        <div class="row">
                            <div class="d-flex col">
                                <form method="post" class="card-body d-flex flex-column">
                                    <div class="pt-1">
                                        <div id="sidePanel" class="side-panel">
                                            <div class="container pt-5 mt-4">

                                                <div class="row">
                                                    <div class="col">
                                                        <p>"Hello, I'm Shakespeare! your friendly AI here to help you
                                                            with
                                                            your
                                                            lyrics... I'll start of with a couple of questions:"</p>
                                                        <form>
                                                            <div class="form-row pt-3">
                                                                <div class="form-group">
                                                                    <label for="Tone">Tone:</label>
                                                                    <select id="Tone" class="form-control">
                                                                        <option selected>Choose...</option>
                                                                        <option>Serious</option>
                                                                        <option>Playful</option>
                                                                        <option>Poetic</option>
                                                                        <option>Casual</option>
                                                                        <option>Energetic</option>
                                                                        <option>Melancholic</option>
                                                                        <option>Hopeful</option>
                                                                        <option>Empowering</option>
                                                                        <option>Dreamy</option>
                                                                        <option>Sarcastic</option>
                                                                        <option>Regretful</option>
                                                                        <option>Confident</option>
                                                                        <option>Mysterious</option>
                                                                        <option>Nostalgic</option>
                                                                        <option>Calm</option>
                                                                    </select>
                                                                </div>
                                                                <div class="form-group pt-4">
                                                                    <label for="TopicOrTheme">Topic/Theme:</label>
                                                                    <input type="text" class="form-control"
                                                                           id="TopicOrTheme"
                                                                           placeholder="What is the specific topic or theme you want?">
                                                                </div>
                                                            </div>
                                                        </form>
                                                    </div>
                                                </div>
                                                <div class="row py-5">
                                                    <div class="col">
                                                        <button type="button"
                                                                class="btn btn-md btn-primary">Clear
                                                        </button>
                                                    </div>
                                                    <div class="col">
                                                        <button type="button"
                                                                class="btn btn-md btn-primary">Generate
                                                        </button>

                                                    </div>
                                                </div>

                                                <div class="row py-4">
                                                    <div class="col">
                                                        Generated Response from an A.I
                                                    </div>
                                                </div>

                                                <div class="row">
                                                    <div>
                                                        <a id="toggleBtn2"
                                                           class="btn btn-primary btn-sm waves-effect waves-light ">Close
                                                        </a>
                                                    </div>
                                                </div>

                                            </div>
                                        </div>

                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>


        <script>
            document.getElementById('toggleBtn').addEventListener('click', function () {
                const panel = document.getElementById('sidePanel');
                if (panel.classList.contains('open')) {
                    panel.classList.remove('open');
                } else {
                    panel.classList.add('open');
                }
            });

            document.getElementById('toggleBtn2').addEventListener('click', function () {
                const panel = document.querySelector('.side-panel');
                if (panel.classList.contains('open')) {
                    panel.classList.remove('open');
                } else {
                    panel.classList.add('open');
                }
            });
        </script>

        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
                integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
                crossorigin="anonymous">
        </script>
        <script>

            async function checkSpelling() {
                const textToCheck = document.getElementById('textToCheck').value;
                const encodedText = encodeURIComponent(textToCheck);
                const url = `https://webspellchecker-webspellcheckernet.p.rapidapi.com/ssrv.cgi?cmd=check_spelling&user_dictionary=Input_Dictionary_Name&text=${encodedText}&slang=en_US&out_type=words&format=xml`;

                const options = {
                    method: 'GET',
                    headers: {
                        'X-RapidAPI-Key': 'YOUR KEY HERE',
                        'X-RapidAPI-Host': 'webspellchecker-webspellcheckernet.p.rapidapi.com'
                    }
                };

                try {
                    const response = await fetch(url, options);
                    const result = await response.text();
                    console.log(result);

                    const parser = new DOMParser();
                    const xmlDoc = parser.parseFromString(result, "text/xml");
                    const errors = xmlDoc.getElementsByTagName("word");

                    let output = '';
                    if (errors.length > 0) {
                        output = '<h5>Spelling Errors:</h5><ul>';
                        for (let i = 0; i < errors.length; i++) {
                            output += `<li>${errors[i].textContent}</li>`;
                        }
                        output += '</ul>';
                    } else {
                        output = '<h5>No spelling errors found.</h5>';
                    }

                    document.getElementById('spellingCheckResults').innerHTML = output;

                } catch (error) {
                    console.error(error);
                }
            }

            document.getElementById('checkSpelling').addEventListener('click', checkSpelling);
        </script>

        <script>
            const profanityFilter = async () => {
                const textToCheck = document.getElementById('textToCheck');
                const url = `https://profanity-filter-by-api-ninjas.p.rapidapi.com/v1/profanityfilter?text=${textToCheck.value}`;
                const options = {
                    method: 'GET',
                    headers: {
                        'X-RapidAPI-Key': 'KEY_HERE',
                        'X-RapidAPI-Host': 'profanity-filter-by-api-ninjas.p.rapidapi.com'
                    }
                };

                try {
                    const response = await fetch(url, options);
                    const result = await response.json(); // Assuming the API returns JSON
                    console.log(result.censored);

                    // Update the value of the input field
                    textToCheck.value = result.censored;

                    // Get the form element
                    const form = document.getElementById('myForm');

                    // Submit the form
                    form.submit();
                } catch (error) {
                    console.error(error);
                }
            }


            // document.querySelector("#createSubmit").addEventListener("click", () => {
            //     profanityFilter();
            // })


        </script>

    </div>
</body>

</html>